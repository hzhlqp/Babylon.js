{"version":3,"file":"tools.js","sourceRoot":"","sources":["../src/tools.ts"],"names":[],"mappings":"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","sourcesContent":["import type { Control } from \"gui/2D/controls/control\";\r\nimport type { Grid } from \"gui/2D/controls/grid\";\r\nimport { Vector2 } from \"core/Maths/math\";\r\n\r\nexport class Tools {\r\n    public static LookForItems(item: any, selectedEntities: any[], firstIteration: boolean = true): boolean {\r\n        if (selectedEntities.length == 0) {\r\n            return false;\r\n        }\r\n\r\n        if (!firstIteration && selectedEntities.includes(item)) {\r\n            return true;\r\n        }\r\n\r\n        const children = item.getChildren ? item.getChildren() : item.children;\r\n        if (children) {\r\n            for (const child of children) {\r\n                if (Tools.LookForItems(child, selectedEntities, false)) {\r\n                    return true;\r\n                }\r\n            }\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    private static _RecursiveRemoveHiddenMeshesAndHoistChildren(items: Array<any>) {\r\n        const result: Array<any> = [];\r\n        for (const i of items) {\r\n            // If the mesh is hidden, add it's children that are not hidden, this will handle the case of bounding box parenting for bounding box gizmo\r\n            if (i.reservedDataStore && i.reservedDataStore.hidden && i.getChildMeshes) {\r\n                Tools._RecursiveRemoveHiddenMeshesAndHoistChildren(i.getChildMeshes()).forEach((m) => {\r\n                    result.push(m);\r\n                });\r\n            } else if (!i.reservedDataStore || !i.reservedDataStore.hidden) {\r\n                result.push(i);\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    public static SortAndFilter(parent: any, items: any[]): any[] {\r\n        if (!items) {\r\n            return [];\r\n        }\r\n\r\n        const finalArray = Tools._RecursiveRemoveHiddenMeshesAndHoistChildren(items);\r\n\r\n        if (parent && parent.reservedDataStore && parent.reservedDataStore.detachedChildren) {\r\n            finalArray.push(...parent.reservedDataStore.detachedChildren);\r\n        }\r\n        return finalArray.reverse();\r\n    }\r\n\r\n    public static GetCellInfo(grid: Grid, control: Control) {\r\n        const cellInfo = grid.getChildCellInfo(control);\r\n        let rowNumber = parseInt(cellInfo.substring(0, cellInfo.search(\":\")));\r\n        if (isNaN(rowNumber)) {\r\n            rowNumber = 0;\r\n        }\r\n        let columnNumber = parseInt(cellInfo.substring(cellInfo.search(\":\") + 1));\r\n        if (isNaN(columnNumber)) {\r\n            columnNumber = 0;\r\n        }\r\n        return new Vector2(rowNumber, columnNumber);\r\n    }\r\n\r\n    public static ReorderGrid(grid: Grid, index: number, control: Control, cell: Vector2) {\r\n        const tags: Vector2[] = [];\r\n        const controls: Control[] = [];\r\n        const length = grid.children.length;\r\n        for (let i = index; i < length; ++i) {\r\n            const control = grid.children[index];\r\n            controls.push(control);\r\n            tags.push(Tools.GetCellInfo(grid, control));\r\n            grid.removeControl(control);\r\n        }\r\n        grid.addControl(control, cell.x, cell.y);\r\n        for (let i = 0; i < controls.length; ++i) {\r\n            grid.addControl(controls[i], tags[i].x, tags[i].y);\r\n        }\r\n    }\r\n}\r\n"]}