{"version":3,"file":"imageSourceDisplayManager.js","sourceRoot":"","sources":["../../../src/graphSystem/display/imageSourceDisplayManager.ts"],"names":[],"mappings":"AAEA,OAAO,EAAE,oBAAoB,EAAE,MAAM,6CAA6C,CAAC;AAGnF,OAAO,WAAW,MAAM,0CAA0C,CAAC;AACnE,OAAO,YAAY,MAAM,uBAAuB,CAAC;AAEjD,MAAM,OAAO,yBAAyB;IAI3B,cAAc;QACjB,OAAO,EAAE,CAAC;IACd,CAAC;IAEM,uBAAuB;QAC1B,OAAO,IAAI,CAAC;IAChB,CAAC;IAEM,aAAa,CAAC,QAAmB;QACpC,OAAQ,QAAQ,CAAC,IAA0B,CAAC,IAAI,CAAC;IACrD,CAAC;IAEM,kBAAkB;QACrB,OAAO,SAAS,CAAC;IACrB,CAAC;IAEM,oBAAoB,CAAC,QAAmB,EAAE,WAA2B;QACxE,MAAM,gBAAgB,GAAG,QAAQ,CAAC,IAAwB,CAAC;QAE3D,IAAI,CAAC,IAAI,CAAC,cAAc,EAAE;YACtB,WAAW,CAAC,SAAS,CAAC,GAAG,CAAC,YAAY,CAAC,eAAe,CAAC,CAAC,CAAC;YACzD,WAAW,CAAC,SAAS,CAAC,GAAG,CAAC,WAAW,CAAC,oBAAoB,CAAC,CAAC,CAAC;YAE7D,IAAI,CAAC,cAAc,GAAG,WAAW,CAAC,aAAc,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;YACzE,IAAI,CAAC,aAAa,GAAG,WAAW,CAAC,aAAc,CAAC,aAAa,CAAC,KAAK,CAAC,CAAC;YACrE,WAAW,CAAC,WAAW,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;YAC5C,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,GAAG,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;SACxD;QAED,IAAI,gBAAgB,CAAC,OAAO,EAAE;YAC1B,oBAAoB,CAAC,aAAa,CAC9B,IAAI,CAAC,cAAc,EACnB,gBAAgB,CAAC,OAAO,EACxB,GAAG,EACH;gBACI,IAAI,EAAE,CAAC;gBACP,UAAU,EAAE,IAAI;gBAChB,YAAY,EAAE,IAAI;gBAClB,WAAW,EAAE,IAAI;gBACjB,YAAY,EAAE,IAAI;aACrB,EACD,GAAG,EAAE;gBACD,IAAI,CAAC,aAAa,CAAC,GAAG,GAAG,IAAI,CAAC,cAAc,CAAC,SAAS,CAAC,WAAW,CAAC,CAAC;gBACpE,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,MAAM,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;YAC5D,CAAC,CACJ,CAAC;SACL;aAAM;YACH,IAAI,CAAC,aAAa,CAAC,SAAS,CAAC,GAAG,CAAC,YAAY,CAAC,KAAK,CAAC,CAAC;SACxD;IACL,CAAC;CACJ","sourcesContent":["import type { NodeMaterialBlock } from \"core/Materials/Node/nodeMaterialBlock\";\r\nimport type { ImageSourceBlock } from \"core/Materials/Node/Blocks/Dual/imageSourceBlock\";\r\nimport { TextureLineComponent } from \"../../sharedComponents/textureLineComponent\";\r\nimport type { IDisplayManager } from \"shared-ui-components/nodeGraphSystem/interfaces/displayManager\";\r\nimport type { INodeData } from \"shared-ui-components/nodeGraphSystem/interfaces/nodeData\";\r\nimport localStyles from \"./imageSourceDisplayManager.modules.scss\";\r\nimport commonStyles from \"./common.modules.scss\";\r\n\r\nexport class ImageSourceDisplayManager implements IDisplayManager {\r\n    private _previewCanvas: HTMLCanvasElement;\r\n    private _previewImage: HTMLImageElement;\r\n\r\n    public getHeaderClass() {\r\n        return \"\";\r\n    }\r\n\r\n    public shouldDisplayPortLabels(): boolean {\r\n        return true;\r\n    }\r\n\r\n    public getHeaderText(nodeData: INodeData): string {\r\n        return (nodeData.data as NodeMaterialBlock).name;\r\n    }\r\n\r\n    public getBackgroundColor(): string {\r\n        return \"#323232\";\r\n    }\r\n\r\n    public updatePreviewContent(nodeData: INodeData, contentArea: HTMLDivElement): void {\r\n        const imageSourceBlock = nodeData.data as ImageSourceBlock;\r\n\r\n        if (!this._previewCanvas) {\r\n            contentArea.classList.add(commonStyles[\"texture-block\"]);\r\n            contentArea.classList.add(localStyles[\"image-source-block\"]);\r\n\r\n            this._previewCanvas = contentArea.ownerDocument!.createElement(\"canvas\");\r\n            this._previewImage = contentArea.ownerDocument!.createElement(\"img\");\r\n            contentArea.appendChild(this._previewImage);\r\n            this._previewImage.classList.add(commonStyles.empty);\r\n        }\r\n\r\n        if (imageSourceBlock.texture) {\r\n            TextureLineComponent.UpdatePreview(\r\n                this._previewCanvas,\r\n                imageSourceBlock.texture,\r\n                140,\r\n                {\r\n                    face: 0,\r\n                    displayRed: true,\r\n                    displayAlpha: true,\r\n                    displayBlue: true,\r\n                    displayGreen: true,\r\n                },\r\n                () => {\r\n                    this._previewImage.src = this._previewCanvas.toDataURL(\"image/png\");\r\n                    this._previewImage.classList.remove(commonStyles.empty);\r\n                }\r\n            );\r\n        } else {\r\n            this._previewImage.classList.add(commonStyles.empty);\r\n        }\r\n    }\r\n}\r\n"]}