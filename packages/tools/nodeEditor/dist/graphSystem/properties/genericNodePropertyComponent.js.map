{"version":3,"file":"genericNodePropertyComponent.js","sourceRoot":"","sources":["../../../src/graphSystem/properties/genericNodePropertyComponent.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from \"react\";\r\nimport { LineContainerComponent } from \"shared-ui-components/lines/lineContainerComponent\";\r\nimport { CheckBoxLineComponent } from \"../../sharedComponents/checkBoxLineComponent\";\r\nimport type { InputBlock } from \"core/Materials/Node/Blocks/Input/inputBlock\";\r\nimport type { IPropertyDescriptionForEdition, IEditablePropertyListOption } from \"core/Decorators/nodeDecorator\";\r\nimport { PropertyTypeForEdition } from \"core/Decorators/nodeDecorator\";\r\nimport { NodeMaterialBlockTargets } from \"core/Materials/Node/Enums/nodeMaterialBlockTargets\";\r\nimport type { NodeMaterialBlock } from \"core/Materials/Node/nodeMaterialBlock\";\r\nimport type { IPropertyComponentProps } from \"shared-ui-components/nodeGraphSystem/interfaces/propertyComponentProps\";\r\nimport { TextInputLineComponent } from \"shared-ui-components/lines/textInputLineComponent\";\r\nimport { Vector2LineComponent } from \"shared-ui-components/lines/vector2LineComponent\";\r\nimport { OptionsLine } from \"shared-ui-components/lines/optionsLineComponent\";\r\nimport { TextLineComponent } from \"shared-ui-components/lines/textLineComponent\";\r\nimport { FloatLineComponent } from \"shared-ui-components/lines/floatLineComponent\";\r\nimport { SliderLineComponent } from \"shared-ui-components/lines/sliderLineComponent\";\r\nimport { ForceRebuild } from \"shared-ui-components/nodeGraphSystem/automaticProperties\";\r\n\r\nexport class GenericPropertyComponent extends React.Component<IPropertyComponentProps> {\r\n    constructor(props: IPropertyComponentProps) {\r\n        super(props);\r\n    }\r\n\r\n    override render() {\r\n        return (\r\n            <>\r\n                <GeneralPropertyTabComponent stateManager={this.props.stateManager} nodeData={this.props.nodeData} />\r\n                <GenericPropertyTabComponent stateManager={this.props.stateManager} nodeData={this.props.nodeData} />\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport class GeneralPropertyTabComponent extends React.Component<IPropertyComponentProps> {\r\n    constructor(props: IPropertyComponentProps) {\r\n        super(props);\r\n    }\r\n\r\n    override render() {\r\n        const targetOptions = [\r\n            { label: \"Neutral\", value: NodeMaterialBlockTargets.Neutral },\r\n            { label: \"Vertex\", value: NodeMaterialBlockTargets.Vertex },\r\n            { label: \"Fragment\", value: NodeMaterialBlockTargets.Fragment },\r\n        ];\r\n\r\n        const block = this.props.nodeData.data as NodeMaterialBlock;\r\n\r\n        return (\r\n            <>\r\n                <LineContainerComponent title=\"GENERAL\">\r\n                    {(!block.isInput || !(block as InputBlock).isAttribute) && (\r\n                        <TextInputLineComponent\r\n                            label=\"Name\"\r\n                            propertyName=\"name\"\r\n                            target={block}\r\n                            lockObject={this.props.stateManager.lockObject}\r\n                            onChange={() => this.props.stateManager.onUpdateRequiredObservable.notifyObservers(block)}\r\n                            throttlePropertyChangedNotification={true}\r\n                            validator={(newName) => {\r\n                                if (!block.validateBlockName(newName)) {\r\n                                    this.props.stateManager.onErrorMessageDialogRequiredObservable.notifyObservers(`\"${newName}\" is a reserved name, please choose another`);\r\n                                    return false;\r\n                                }\r\n                                return true;\r\n                            }}\r\n                        />\r\n                    )}\r\n                    {block._originalTargetIsNeutral && (\r\n                        <OptionsLine\r\n                            label=\"Target\"\r\n                            options={targetOptions}\r\n                            target={block}\r\n                            propertyName=\"target\"\r\n                            onSelect={() => {\r\n                                this.forceUpdate();\r\n\r\n                                this.props.stateManager.onUpdateRequiredObservable.notifyObservers(block);\r\n                                this.props.stateManager.onRebuildRequiredObservable.notifyObservers();\r\n                            }}\r\n                        />\r\n                    )}\r\n                    {!block._originalTargetIsNeutral && <TextLineComponent label=\"Target\" value={NodeMaterialBlockTargets[block.target]} />}\r\n                    <TextLineComponent label=\"Type\" value={block.getClassName()} />\r\n                    <TextInputLineComponent\r\n                        label=\"Comments\"\r\n                        propertyName=\"comments\"\r\n                        lockObject={this.props.stateManager.lockObject}\r\n                        target={block}\r\n                        onChange={() => this.props.stateManager.onUpdateRequiredObservable.notifyObservers(block)}\r\n                        throttlePropertyChangedNotification={true}\r\n                    />\r\n                </LineContainerComponent>\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport class GenericPropertyTabComponent extends React.Component<IPropertyComponentProps> {\r\n    constructor(props: IPropertyComponentProps) {\r\n        super(props);\r\n    }\r\n\r\n    override render() {\r\n        const block = this.props.nodeData.data as NodeMaterialBlock,\r\n            propStore: IPropertyDescriptionForEdition[] = (block as any)._propStore;\r\n\r\n        if (!propStore) {\r\n            return <></>;\r\n        }\r\n\r\n        const componentList: { [groupName: string]: JSX.Element[] } = {},\r\n            groups: string[] = [];\r\n\r\n        for (const { propertyName, displayName, type, groupName, options } of propStore) {\r\n            let components = componentList[groupName];\r\n\r\n            if (options.embedded) {\r\n                continue;\r\n            }\r\n\r\n            if (!components) {\r\n                components = [];\r\n                componentList[groupName] = components;\r\n                groups.push(groupName);\r\n            }\r\n\r\n            switch (type) {\r\n                case PropertyTypeForEdition.Boolean: {\r\n                    components.push(\r\n                        <CheckBoxLineComponent\r\n                            key={`checkBox-${propertyName}`}\r\n                            label={displayName}\r\n                            target={block}\r\n                            propertyName={propertyName}\r\n                            onValueChanged={() => ForceRebuild(block, this.props.stateManager, propertyName, options.notifiers)}\r\n                        />\r\n                    );\r\n                    break;\r\n                }\r\n                case PropertyTypeForEdition.Float: {\r\n                    const cantDisplaySlider = isNaN(options.min as number) || isNaN(options.max as number) || options.min === options.max;\r\n                    if (cantDisplaySlider) {\r\n                        components.push(\r\n                            <FloatLineComponent\r\n                                key={`float-${propertyName}`}\r\n                                lockObject={this.props.stateManager.lockObject}\r\n                                label={displayName}\r\n                                propertyName={propertyName}\r\n                                target={block}\r\n                                onChange={() => ForceRebuild(block, this.props.stateManager, propertyName, options.notifiers)}\r\n                            />\r\n                        );\r\n                    } else {\r\n                        components.push(\r\n                            <SliderLineComponent\r\n                                key={`slider-${propertyName}`}\r\n                                lockObject={this.props.stateManager.lockObject}\r\n                                label={displayName}\r\n                                target={block}\r\n                                propertyName={propertyName}\r\n                                step={Math.abs((options.max as number) - (options.min as number)) / 100.0}\r\n                                minimum={Math.min(options.min as number, options.max as number)}\r\n                                maximum={options.max as number}\r\n                                onChange={() => ForceRebuild(block, this.props.stateManager, propertyName, options.notifiers)}\r\n                            />\r\n                        );\r\n                    }\r\n                    break;\r\n                }\r\n                case PropertyTypeForEdition.Int: {\r\n                    components.push(\r\n                        <FloatLineComponent\r\n                            key={`int-${propertyName}`}\r\n                            lockObject={this.props.stateManager.lockObject}\r\n                            digits={0}\r\n                            step={\"1\"}\r\n                            isInteger={true}\r\n                            label={displayName}\r\n                            propertyName={propertyName}\r\n                            target={block}\r\n                            onChange={() => ForceRebuild(block, this.props.stateManager, propertyName, options.notifiers)}\r\n                        />\r\n                    );\r\n                    break;\r\n                }\r\n                case PropertyTypeForEdition.Vector2: {\r\n                    components.push(\r\n                        <Vector2LineComponent\r\n                            key={`vector2-${propertyName}`}\r\n                            lockObject={this.props.stateManager.lockObject}\r\n                            label={displayName}\r\n                            propertyName={propertyName}\r\n                            target={block}\r\n                            onChange={() => ForceRebuild(block, this.props.stateManager, propertyName, options.notifiers)}\r\n                        />\r\n                    );\r\n                    break;\r\n                }\r\n                case PropertyTypeForEdition.List: {\r\n                    components.push(\r\n                        <OptionsLine\r\n                            key={`options-${propertyName}`}\r\n                            label={displayName}\r\n                            options={options.options as IEditablePropertyListOption[]}\r\n                            target={block}\r\n                            propertyName={propertyName}\r\n                            onSelect={() => ForceRebuild(block, this.props.stateManager, propertyName, options.notifiers)}\r\n                        />\r\n                    );\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n\r\n        return (\r\n            <>\r\n                {groups.map((group) => (\r\n                    <LineContainerComponent key={`group-${group}`} title={group}>\r\n                        {componentList[group]}\r\n                    </LineContainerComponent>\r\n                ))}\r\n            </>\r\n        );\r\n    }\r\n}\r\n"]}