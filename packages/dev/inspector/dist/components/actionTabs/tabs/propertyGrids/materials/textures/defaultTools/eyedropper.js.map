{"version":3,"file":"eyedropper.js","sourceRoot":"","sources":["../../../../../../../../src/components/actionTabs/tabs/propertyGrids/materials/textures/defaultTools/eyedropper.ts"],"names":[],"mappings":"AAEA,OAAO,EAAE,iBAAiB,EAAE,MAAM,2BAA2B,CAAC;AAG9D,OAAO,EAAE,MAAM,EAAE,MAAM,uBAAuB,CAAC;AAE/C,MAAM,CAAC,MAAM,UAAU,GAAc;IACjC,IAAI,EAAE,YAAY;IAClB,IAAI,EAAE;QAKF,YAAY,aAAoC;YAC5C,IAAI,CAAC,aAAa,GAAG,aAAa,CAAC;QACvC,CAAC;QAED,IAAI,CAAC,WAAwB;YACzB,MAAM,EAAE,QAAQ,EAAE,WAAW,EAAE,mBAAmB,EAAE,GAAG,IAAI,CAAC,aAAa,EAAE,CAAC;YAC5E,MAAM,GAAG,GAAG,QAAQ,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;YACtC,MAAM,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,mBAAmB,CAAC,WAAW,CAAC,CAAC;YAClD,MAAM,KAAK,GAAG,GAAI,CAAC,YAAY,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC;YACjD,WAAW,CAAC;gBACR,KAAK,EAAE,MAAM,CAAC,QAAQ,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,EAAE,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC,WAAW,EAAE;gBAClE,KAAK,EAAE,KAAK,CAAC,CAAC,CAAC,GAAG,GAAG;aACxB,CAAC,CAAC;QACP,CAAC;QAED,KAAK;YACD,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,aAAa,EAAE,CAAC,KAAK,CAAC,mBAAmB,CAAC,GAAG,CAAC,CAAC,WAAW,EAAE,EAAE;gBACtF,IAAI,WAAW,CAAC,QAAQ,EAAE,GAAG,EAAE;oBAC3B,IAAI,WAAW,CAAC,IAAI,KAAK,iBAAiB,CAAC,WAAW,IAAI,WAAW,CAAC,KAAK,CAAC,OAAO,KAAK,CAAC,IAAI,IAAI,CAAC,aAAa,EAAE,CAAC,kBAAkB,EAAE,EAAE;wBACpI,IAAI,CAAC,SAAS,GAAG,IAAI,CAAC;wBACtB,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;qBAC1B;oBACD,IAAI,IAAI,CAAC,SAAS,EAAE;wBAChB,IAAI,WAAW,CAAC,KAAK,CAAC,OAAO,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE,CAAC,kBAAkB,EAAE,EAAE;4BAC/E,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;yBAC1B;6BAAM;4BACH,IAAI,CAAC,IAAI,CAAC,WAAW,CAAC,CAAC;yBAC1B;qBACJ;iBACJ;YACL,CAAC,CAAC,CAAC;YACH,IAAI,CAAC,SAAS,GAAG,KAAK,CAAC;QAC3B,CAAC;QACD,OAAO;YACH,IAAI,IAAI,CAAC,eAAe,EAAE;gBACtB,IAAI,CAAC,aAAa,EAAE,CAAC,KAAK,CAAC,mBAAmB,CAAC,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;aAC/E;QACL,CAAC;KACJ;IACD,IAAI,EAAE;;;;;;qGAM2F;IACjG,MAAM,EAAE,0sBAA0sB;CACrtB,CAAC","sourcesContent":["import type { IToolParameters, IToolData } from \"../textureEditorComponent\";\r\nimport type { PointerInfo } from \"core/Events/pointerEvents\";\r\nimport { PointerEventTypes } from \"core/Events/pointerEvents\";\r\nimport type { Nullable } from \"core/types\";\r\nimport type { Observer } from \"core/Misc/observable\";\r\nimport { Color3 } from \"core/Maths/math.color\";\r\n\r\nexport const Eyedropper: IToolData = {\r\n    name: \"Eyedropper\",\r\n    type: class {\r\n        getParameters: () => IToolParameters;\r\n        pointerObserver: Nullable<Observer<PointerInfo>>;\r\n        isPicking: boolean;\r\n\r\n        constructor(getParameters: () => IToolParameters) {\r\n            this.getParameters = getParameters;\r\n        }\r\n\r\n        pick(pointerInfo: PointerInfo) {\r\n            const { canvas2D, setMetadata, getMouseCoordinates } = this.getParameters();\r\n            const ctx = canvas2D.getContext(\"2d\");\r\n            const { x, y } = getMouseCoordinates(pointerInfo);\r\n            const pixel = ctx!.getImageData(x, y, 1, 1).data;\r\n            setMetadata({\r\n                color: Color3.FromInts(pixel[0], pixel[1], pixel[2]).toHexString(),\r\n                alpha: pixel[3] / 255,\r\n            });\r\n        }\r\n\r\n        setup() {\r\n            this.pointerObserver = this.getParameters().scene.onPointerObservable.add((pointerInfo) => {\r\n                if (pointerInfo.pickInfo?.hit) {\r\n                    if (pointerInfo.type === PointerEventTypes.POINTERDOWN && pointerInfo.event.buttons === 1 && this.getParameters().interactionEnabled()) {\r\n                        this.isPicking = true;\r\n                        this.pick(pointerInfo);\r\n                    }\r\n                    if (this.isPicking) {\r\n                        if (pointerInfo.event.buttons !== 1 || !this.getParameters().interactionEnabled()) {\r\n                            this.isPicking = false;\r\n                        } else {\r\n                            this.pick(pointerInfo);\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n            this.isPicking = false;\r\n        }\r\n        cleanup() {\r\n            if (this.pointerObserver) {\r\n                this.getParameters().scene.onPointerObservable.remove(this.pointerObserver);\r\n            }\r\n        }\r\n    },\r\n    icon: `PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDQwIDQwIj48cmVjdCB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHN0eWxlPSJmaWxsOm5vbmUiLz48cGF0aCBkPSJNMjkuMzIsMTAu\r\n    NjhjLTEuNjYtMS42Ni00LjA2LTEtNS41Ni41YTExLjg5LDExLjg5LDAsMCwwLTEuNjYsMi4zMUwyMiwxMy40MWExLjg5LDEuODksMCwwLDAtMi42NiwwbC0uOS45YTEuODksMS44OSwwLDAsMC0uMjIsMi4zOWwtNi4wOSw2LjA5YTIuNzUsMi43NSwwLDAsMC0uNzMs\r\n    MS4yOGwtLjgxLDMuMjYtLjU2LjU2YTEuMTYsMS4xNiwwLDAsMCwwLDEuNjVsLjQxLjQxYTEuMTcsMS4xNywwLDAsMCwxLjY1LDBsLjU2LS41NiwzLjI2LS44MWEyLjc1LDIuNzUsMCwwLDAsMS4yOC0uNzNsNi4xNC02LjE0YTEuODcsMS44NywwLDAsMCwuODQuMjEs\r\n    MS44MywxLjgzLDAsMCwwLDEuMzMtLjU1bC45LS45YTEuODcsMS44NywwLDAsMCwuMDgtMi41NywxMS41NCwxMS41NCwwLDAsMCwyLjMyLTEuNjZDMzAuMzIsMTQuNzQsMzEsMTIuMzUsMjkuMzIsMTAuNjhaTTE2LjE1LDI2Ljc5YTEuMjEsMS4yMSwwLDAsMS0uNTgu\r\n    MzNMMTIsMjhsLjktMy41OWExLjIxLDEuMjEsMCwwLDEsLjMzLS41OGw2LjA3LTYuMDcsMi45NCwyLjk0Wm05LjIxLTcuMzgtLjkuOWMtLjE5LjItLjM0LjItLjU0LDBsLTQuNC00LjRhLjQuNCwwLDAsMSwwLS41NGwuOS0uOWEuNDMuNDMsMCwwLDEsLjI3LS4xMS4z\r\n    OS4zOSwwLDAsMSwuMjcuMTFsNC40LDQuNEEuMzguMzgsMCwwLDEsMjUuMzYsMTkuNDFabTMuMzgtNS45M2EzLjcsMy43LDAsMCwxLTEsMS43LDExLjY3LDExLjY3LDAsMCwxLTIuMzUsMS42MkwyMy4yLDE0LjU5YTExLjY3LDExLjY3LDAsMCwxLDEuNjItMi4zNSwz\r\n    LjcsMy43LDAsMCwxLDEuNy0xLDEuODMsMS44MywwLDAsMSwyLjIyLDIuMjJaIiBzdHlsZT0iZmlsbDojZmZmIi8+PC9zdmc+`,\r\n    cursor: `iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAABmJLR0QA/wD/AP+gvaeTAAAByklEQVQ4jbWUv4saQRTHd+4s/BuCYRH1n7BQEhCRuyJ3RQgpRVt/tFvYSAjLxMPiWIJ1OA6OKwKBdCGBkIS4pFs76xgXhOlyyconzSrrojub4l618+a9z/u+mTdrGPdgIk0QwDZBCG3OUerqepYeCgigAbyJ+a+AEyB9lTDxAfBhPp9jWRZh+wB0u11msxnAJyCXSmkI/DIejx9Vq1Ujm83u7OdyOaPRaBi2bVeAr8BDnUIBfJRSUi6XWSwWa+B1VClw6ft+UKlUsG0b4DNw+G6AU8/zME2T5XIZAE9C/xYark983/9rmubmKM6SoNedTofRaARwqenqQkpJr9cDuI3uiYiSvbaZS4Dod1J8JrJIUoUQYgs+FLuplYk79lQ2hBAipvSggH2Vbvr9PlJKgFea2JeO49BqtQDeJgWee55HPp9ntVr9AR6H/vjtV5VSd8Vikel0CvA0CXoEfBsOh9RqNZRSd8CL2JwOlVK/6/X65rVNgWPdEeTX6/XPwWBAqVRiMpnsPFPHcSgUCliWRRAEv4BCIjAKBr67rkuz2dyBttttXNcF+AEUUwEj4GPgGfAu1v574DmQ0UI0BXYuSmepf9L/NZv3Yf8AKtG4imEra4UAAAAASUVORK5CYII=`,\r\n};\r\n"]}