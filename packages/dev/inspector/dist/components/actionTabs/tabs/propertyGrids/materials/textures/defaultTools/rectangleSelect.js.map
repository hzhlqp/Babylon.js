{"version":3,"file":"rectangleSelect.js","sourceRoot":"","sources":["../../../../../../../../src/components/actionTabs/tabs/propertyGrids/materials/textures/defaultTools/rectangleSelect.ts"],"names":[],"mappings":"AAEA,OAAO,EAAE,iBAAiB,EAAE,MAAM,2BAA2B,CAAC;AAI9D,MAAM,CAAC,MAAM,eAAe,GAAc;IACtC,IAAI,EAAE,kBAAkB;IACxB,IAAI,EAAE;QAMF,YAAY,aAAoC;YAHhD,gBAAW,GAAG,KAAK,CAAC;YACpB,WAAM,GAAW,CAAC,CAAC,CAAC;YACpB,WAAM,GAAW,CAAC,CAAC,CAAC;YAEhB,IAAI,CAAC,aAAa,GAAG,aAAa,CAAC;QACvC,CAAC;QACD,KAAK;YACD,MAAM,EAAE,KAAK,EAAE,GAAG,IAAI,CAAC,aAAa,EAAE,CAAC;YACvC,IAAI,CAAC,eAAe,GAAG,KAAK,CAAC,mBAAmB,CAAC,GAAG,CAAC,CAAC,WAAW,EAAE,EAAE;gBACjE,MAAM,EAAE,mBAAmB,EAAE,WAAW,EAAE,QAAQ,EAAE,GAAG,IAAI,CAAC,aAAa,EAAE,CAAC;gBAC5E,IAAI,CAAC,IAAI,CAAC,WAAW,EAAE;oBACnB,IACI,WAAW,CAAC,IAAI,IAAI,iBAAiB,CAAC,WAAW;wBACjD,WAAW;wBACX,WAAW,CAAC,KAAK,CAAC,OAAO,KAAK,CAAC;wBAC/B,IAAI,CAAC,aAAa,EAAE,CAAC,kBAAkB,EAAE;wBACzC,WAAW,CAAC,QAAQ,EAAE,GAAG,EAC3B;wBACE,IAAI,CAAC,WAAW,GAAG,IAAI,CAAC;wBACxB,MAAM,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,CAAC,EAAE,CAAC,EAAE,IAAI,CAAC,MAAM,EAAE,CAAC,EAAE,IAAI,CAAC,MAAM,EAAE,GAAG,mBAAmB,CAAC,WAAW,CAAC,CAAC,CAAC;wBACzF,WAAW,CAAC;4BACR,MAAM,EAAE;gCACJ,EAAE,EAAE,CAAC;gCACL,EAAE,EAAE,CAAC;gCACL,EAAE,EAAE,CAAC;gCACL,EAAE,EAAE,CAAC;6BACR;yBACJ,CAAC,CAAC;qBACN;iBACJ;qBAAM;oBACH,IAAI,WAAW,CAAC,KAAK,CAAC,OAAO,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,aAAa,EAAE,CAAC,kBAAkB,EAAE,EAAE;wBAC/E,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;wBACzB,IAAI,QAAQ,CAAC,MAAM,CAAC,EAAE,KAAK,QAAQ,CAAC,MAAM,CAAC,EAAE,IAAI,QAAQ,CAAC,MAAM,CAAC,EAAE,KAAK,QAAQ,CAAC,MAAM,CAAC,EAAE,EAAE;4BACxF,WAAW,CAAC;gCACR,MAAM,EAAE;oCACJ,EAAE,EAAE,CAAC,CAAC;oCACN,EAAE,EAAE,CAAC,CAAC;oCACN,EAAE,EAAE,CAAC,CAAC;oCACN,EAAE,EAAE,CAAC,CAAC;iCACT;6BACJ,CAAC,CAAC;yBACN;qBACJ;yBAAM;wBACH,IAAI,WAAW,CAAC,QAAQ,EAAE,GAAG,IAAI,WAAW,CAAC,IAAI,KAAK,iBAAiB,CAAC,WAAW,EAAE;4BACjF,IAAI,WAAW,CAAC,IAAI,KAAK,iBAAiB,CAAC,WAAW,IAAI,IAAI,CAAC,WAAW,EAAE;gCACxE,MAAM,EAAE,CAAC,EAAE,CAAC,EAAE,GAAG,mBAAmB,CAAC,WAAW,CAAC,CAAC;gCAClD,WAAW,CAAC;oCACR,MAAM,EAAE;wCACJ,EAAE,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,MAAM,CAAC;wCAC5B,EAAE,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,MAAM,CAAC;wCAC5B,EAAE,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,MAAM,CAAC;wCAC5B,EAAE,EAAE,IAAI,CAAC,GAAG,CAAC,CAAC,EAAE,IAAI,CAAC,MAAM,CAAC;qCAC/B;iCACJ,CAAC,CAAC;6BACN;yBACJ;qBACJ;iBACJ;YACL,CAAC,CAAC,CAAC;QACP,CAAC;QACD,OAAO;YACH,IAAI,CAAC,WAAW,GAAG,KAAK,CAAC;YACzB,IAAI,IAAI,CAAC,eAAe,EAAE;gBACtB,IAAI,CAAC,aAAa,EAAE,CAAC,KAAK,CAAC,mBAAmB,CAAC,MAAM,CAAC,IAAI,CAAC,eAAe,CAAC,CAAC;aAC/E;QACL,CAAC;KACJ;IACD,IAAI,EAAE,knCAAknC;IACxnC,MAAM,EAAE,kMAAkM;CAC7M,CAAC","sourcesContent":["import type { IToolData, IToolParameters } from \"../textureEditorComponent\";\r\nimport type { PointerInfo } from \"core/Events/pointerEvents\";\r\nimport { PointerEventTypes } from \"core/Events/pointerEvents\";\r\nimport type { Nullable } from \"core/types\";\r\nimport type { Observer } from \"core/Misc/observable\";\r\n\r\nexport const RectangleSelect: IToolData = {\r\n    name: \"Rectangle Select\",\r\n    type: class {\r\n        getParameters: () => IToolParameters;\r\n        pointerObserver: Nullable<Observer<PointerInfo>>;\r\n        isSelecting = false;\r\n        xStart: number = -1;\r\n        yStart: number = -1;\r\n        constructor(getParameters: () => IToolParameters) {\r\n            this.getParameters = getParameters;\r\n        }\r\n        setup() {\r\n            const { scene } = this.getParameters();\r\n            this.pointerObserver = scene.onPointerObservable.add((pointerInfo) => {\r\n                const { getMouseCoordinates, setMetadata, metadata } = this.getParameters();\r\n                if (!this.isSelecting) {\r\n                    if (\r\n                        pointerInfo.type == PointerEventTypes.POINTERDOWN &&\r\n                        pointerInfo &&\r\n                        pointerInfo.event.buttons === 1 &&\r\n                        this.getParameters().interactionEnabled() &&\r\n                        pointerInfo.pickInfo?.hit\r\n                    ) {\r\n                        this.isSelecting = true;\r\n                        const { x, y } = ({ x: this.xStart, y: this.yStart } = getMouseCoordinates(pointerInfo));\r\n                        setMetadata({\r\n                            select: {\r\n                                x1: x,\r\n                                y1: y,\r\n                                x2: x,\r\n                                y2: y,\r\n                            },\r\n                        });\r\n                    }\r\n                } else {\r\n                    if (pointerInfo.event.buttons !== 1 || !this.getParameters().interactionEnabled()) {\r\n                        this.isSelecting = false;\r\n                        if (metadata.select.x1 === metadata.select.x2 || metadata.select.y1 === metadata.select.y2) {\r\n                            setMetadata({\r\n                                select: {\r\n                                    x1: -1,\r\n                                    y1: -1,\r\n                                    x2: -1,\r\n                                    y2: -1,\r\n                                },\r\n                            });\r\n                        }\r\n                    } else {\r\n                        if (pointerInfo.pickInfo?.hit && pointerInfo.type === PointerEventTypes.POINTERMOVE) {\r\n                            if (pointerInfo.type === PointerEventTypes.POINTERMOVE && this.isSelecting) {\r\n                                const { x, y } = getMouseCoordinates(pointerInfo);\r\n                                setMetadata({\r\n                                    select: {\r\n                                        x1: Math.min(x, this.xStart),\r\n                                        y1: Math.min(y, this.yStart),\r\n                                        x2: Math.max(x, this.xStart),\r\n                                        y2: Math.max(y, this.yStart),\r\n                                    },\r\n                                });\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        cleanup() {\r\n            this.isSelecting = false;\r\n            if (this.pointerObserver) {\r\n                this.getParameters().scene.onPointerObservable.remove(this.pointerObserver);\r\n            }\r\n        }\r\n    },\r\n    icon: `PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0MCIgaGVpZ2h0PSI0MCIgdmlld0JveD0iMCAwIDQwIDQwIj48cmVjdCB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHN0eWxlPSJmaWxsOm5vbmUiLz48cGF0aCBkPSJNMTEuNjMsMTUuNjNIMTAuMzh2LTMuN2ExLjU0LDEuNTQsMCwwLDEsMS41NS0xLjU1aDMuN3YxLjI1SDEyLjI1YS42Mi42MiwwLDAsMC0uNjIuNjJaIiBzdHlsZT0iZmlsbDojZmZmIi8+PHBhdGggZD0iTTExLjYzLDIyLjYzSDEwLjM4VjE3LjM4aDEuMjVaIiBzdHlsZT0iZmlsbDojZmZmIi8+PHBhdGggZD0iTTI5LjYzLDIyLjYzSDI4LjM4VjE3LjM4aDEuMjVaIiBzdHlsZT0iZmlsbDojZmZmIi8+PHBhdGggZD0iTTE1LjYzLDI5LjYzaC0zLjdhMS41NSwxLjU1LDAsMCwxLTEuNTUtMS41NlYyNC4zOGgxLjI1djMuMzdhLjYzLjYzLDAsMCwwLC42Mi42M2gzLjM4WiIgc3R5bGU9ImZpbGw6I2ZmZiIvPjxwYXRoIGQ9Ik0yOC4wNywyOS42M0gyNC4zOFYyOC4zOGgzLjM3YS42NC42NCwwLDAsMCwuNjMtLjYzVjI0LjM4aDEuMjV2My42OUExLjU2LDEuNTYsMCwwLDEsMjguMDcsMjkuNjNaIiBzdHlsZT0iZmlsbDojZmZmIi8+PHBhdGggZD0iTTIyLjYzLDExLjYzSDE3LjM4VjEwLjM4aDUuMjVaIiBzdHlsZT0iZmlsbDojZmZmIi8+PHBhdGggZD0iTTI5LjYzLDE1LjYzSDI4LjM4VjEyLjI1YS42My42MywwLDAsMC0uNjMtLjYySDI0LjM4VjEwLjM4aDMuNjlhMS41NSwxLjU1LDAsMCwxLDEuNTYsMS41NVoiIHN0eWxlPSJmaWxsOiNmZmYiLz48cGF0aCBkPSJNMjIuNjMsMjkuNjNIMTcuMzhWMjguMzhoNS4yNVoiIHN0eWxlPSJmaWxsOiNmZmYiLz48L3N2Zz4=`,\r\n    cursor: `iVBORw0KGgoAAAANSUhEUgAAABUAAAAVAgMAAADUeU0FAAAACVBMVEUAAAAAAAD///+D3c/SAAAAAXRSTlMAQObYZgAAAAFiS0dEAmYLfGQAAAAnSURBVAjXY2CAAS0IpUY0BdG1ikNrFQODaqiaaBicBwfEG6aF0AQA4oYGiJg4woEAAAAASUVORK5CYII=`,\r\n};\r\n"]}