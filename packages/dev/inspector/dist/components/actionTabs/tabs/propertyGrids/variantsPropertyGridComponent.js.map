{"version":3,"file":"variantsPropertyGridComponent.js","sourceRoot":"","sources":["../../../../../src/components/actionTabs/tabs/propertyGrids/variantsPropertyGridComponent.tsx"],"names":[],"mappings":";AAAA,OAAO,KAAK,KAAK,MAAM,OAAO,CAAC;AAM/B,OAAO,EAAE,sBAAsB,EAAE,MAAM,mDAAmD,CAAC;AAG3F,OAAO,EAAE,WAAW,EAAE,MAAM,iDAAiD,CAAC;AAY9E,MAAM,OAAO,6BAA8B,SAAQ,KAAK,CAAC,SAA8C;IACnG,YAAY,KAA0C;QAClD,KAAK,CAAC,KAAK,CAAC,CAAC;IACjB,CAAC;IAEO,qBAAqB;QACzB,OAAO,IAAI,CAAC,KAAK,CAAC,WAAW,EAAE,oBAAoB,CAAC,wBAAwB,CAA2B,CAAC;IAC5G,CAAC;IAEQ,MAAM;QACX,MAAM,SAAS,GAAG,IAAI,CAAC,qBAAqB,EAAE,CAAC;QAC/C,IAAI,CAAC,SAAS,EAAE;YACZ,OAAO,IAAI,CAAC;SACf;QACD,MAAM,QAAQ,GAAa,SAAS,CAAC,oBAAoB,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;QAE3E,IAAI,CAAC,QAAQ,IAAI,QAAQ,CAAC,MAAM,KAAK,CAAC,EAAE;YACpC,OAAO,IAAI,CAAC;SACf;QAED,MAAM,OAAO,GAAG,QAAQ,CAAC,IAAI,EAAE,CAAC,GAAG,CAAC,CAAC,CAAS,EAAE,CAAS,EAAE,EAAE;YACzD,OAAO,EAAE,KAAK,EAAE,CAAC,EAAE,KAAK,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC;QACtC,CAAC,CAAC,CAAC;QAEH,OAAO,CAAC,MAAM,CAAC,CAAC,EAAE,CAAC,EAAE,EAAE,KAAK,EAAE,UAAU,EAAE,KAAK,EAAE,CAAC,EAAE,CAAC,CAAC;QAEtD,OAAO,CACH,wBACI,KAAC,sBAAsB,IAAC,KAAK,EAAC,UAAU,EAAC,SAAS,EAAE,IAAI,CAAC,KAAK,CAAC,WAAW,YACtE,KAAC,WAAW,IACR,KAAK,EAAC,gBAAgB,EACtB,OAAO,EAAE,OAAO,EAChB,cAAc,EAAE,IAAI,EACpB,MAAM,EAAE,IAAI,CAAC,KAAK,CAAC,IAAI,EACvB,YAAY,EAAC,EAAE,EACf,QAAQ,EAAE,CAAC,KAAK,EAAE,EAAE;wBAChB,MAAM,aAAa,GAAG,KAAe,CAAC;wBACtC,IAAI,aAAa,KAAK,CAAC,EAAE;4BACrB,SAAS,CAAC,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,CAAC;yBACpC;6BAAM;4BACH,SAAS,CAAC,aAAa,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,EAAE,QAAQ,CAAC,aAAa,GAAG,CAAC,CAAC,CAAC,CAAC;yBACzE;wBACD,IAAI,CAAC,WAAW,EAAE,CAAC;oBACvB,CAAC,EACD,YAAY,EAAE,GAAG,EAAE;wBACf,MAAM,iBAAiB,GAAG,SAAS,CAAC,sBAAsB,CAAC,IAAI,CAAC,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;wBACjF,IAAI,KAAK,GAAG,CAAC,CAAC;wBACd,IAAI,iBAAiB,IAAI,MAAM,CAAC,SAAS,CAAC,QAAQ,CAAC,IAAI,CAAC,iBAAiB,CAAC,KAAK,iBAAiB,EAAE;4BAC9F,KAAK,GAAG,QAAQ,CAAC,OAAO,CAAC,iBAA2B,CAAC,CAAC;4BACtD,IAAI,KAAK,GAAG,CAAC,CAAC,EAAE;gCACZ,KAAK,GAAG,KAAK,GAAG,CAAC,CAAC;6BACrB;yBACJ;wBAED,OAAO,KAAK,CAAC;oBACjB,CAAC,GACH,GACmB,GACvB,CACT,CAAC;IACN,CAAC;CACJ","sourcesContent":["import * as React from \"react\";\r\n\r\nimport type { Observable } from \"core/Misc/observable\";\r\nimport type { Nullable } from \"core/types\";\r\n\r\nimport type { PropertyChangedEvent } from \"../../../propertyChangedEvent\";\r\nimport { LineContainerComponent } from \"shared-ui-components/lines/lineContainerComponent\";\r\nimport type { LockObject } from \"shared-ui-components/tabs/propertyGrids/lockObject\";\r\nimport type { GlobalState } from \"../../../globalState\";\r\nimport { OptionsLine } from \"shared-ui-components/lines/optionsLineComponent\";\r\n\r\n// eslint-disable-next-line @typescript-eslint/naming-convention\r\nimport type { KHR_materials_variants } from \"loaders/glTF/2.0/Extensions/KHR_materials_variants\";\r\n\r\ninterface IVariantsPropertyGridComponentProps {\r\n    globalState: GlobalState;\r\n    host: any;\r\n    lockObject: LockObject;\r\n    onPropertyChangedObservable?: Observable<PropertyChangedEvent>;\r\n}\r\n\r\nexport class VariantsPropertyGridComponent extends React.Component<IVariantsPropertyGridComponentProps> {\r\n    constructor(props: IVariantsPropertyGridComponentProps) {\r\n        super(props);\r\n    }\r\n\r\n    private _getVariantsExtension(): Nullable<KHR_materials_variants> {\r\n        return this.props.globalState?.glTFLoaderExtensions[\"KHR_materials_variants\"] as KHR_materials_variants;\r\n    }\r\n\r\n    override render() {\r\n        const extension = this._getVariantsExtension();\r\n        if (!extension) {\r\n            return null;\r\n        }\r\n        const variants: string[] = extension.getAvailableVariants(this.props.host);\r\n\r\n        if (!variants || variants.length === 0) {\r\n            return null;\r\n        }\r\n\r\n        const options = variants.sort().map((v: string, i: number) => {\r\n            return { label: v, value: i + 1 };\r\n        });\r\n\r\n        options.splice(0, 0, { label: \"Original\", value: 0 });\r\n\r\n        return (\r\n            <div>\r\n                <LineContainerComponent title=\"VARIANTS\" selection={this.props.globalState}>\r\n                    <OptionsLine\r\n                        label=\"Active variant\"\r\n                        options={options}\r\n                        noDirectUpdate={true}\r\n                        target={this.props.host}\r\n                        propertyName=\"\"\r\n                        onSelect={(value) => {\r\n                            const valueAsNumber = value as number;\r\n                            if (valueAsNumber === 0) {\r\n                                extension.reset(this.props.host);\r\n                            } else {\r\n                                extension.selectVariant(this.props.host, variants[valueAsNumber - 1]);\r\n                            }\r\n                            this.forceUpdate();\r\n                        }}\r\n                        extractValue={() => {\r\n                            const lastPickedVariant = extension.getLastSelectedVariant(this.props.host) || 0;\r\n                            let index = 0;\r\n                            if (lastPickedVariant && Object.prototype.toString.call(lastPickedVariant) === \"[object String]\") {\r\n                                index = variants.indexOf(lastPickedVariant as string);\r\n                                if (index > -1) {\r\n                                    index = index + 1;\r\n                                }\r\n                            }\r\n\r\n                            return index;\r\n                        }}\r\n                    />\r\n                </LineContainerComponent>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n"]}